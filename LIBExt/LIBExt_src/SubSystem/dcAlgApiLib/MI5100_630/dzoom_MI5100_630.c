//*****************************************************************************
//     Program        :    Digitaql Zoom for MI1030
//     Author        :
//    Goal        :    Setup various digital zoom
//     Functions    :
//*****************************************************************************
#include "sensor_model.h"

#if MI5100_630
//#NT#2009/10/20#Jarkko Chang -begin
//#NT#modify for hd500c3 8x dzoom using
UINT16 MAX_Dzoom_Step = 40;
const UINT8 gucDzoomTable[31]={
10,
//step0
11,
12,
14,
18,
20,
//step1
22,
24,
26,
28,
30,
//step2
32,
34,
36,
38,
40,
//step3
42,
44,
46,
48,
50,
//step4
52,54,57,60,63,66,70,73,76,80
};
//#NT#2009/10/20#Jarkko Chang -end


#if 1
//vga
//8x dzoom
UINT16 VDOZOOM_INFOR_TABLE[61][8] =
{
//sie_in      pre_out     ipe_out    crop size
{ 640,  480,  640,  480,  624,   480, 2560, 1920},
{ 616,  460,  608,  460,  592,   460, 2464, 1848},
{ 596,  444,  592,  444,  576,   444, 2384, 1788},
{ 576,  432,  576,  432,  560,   432, 2304, 1728},
{ 556,  416,  544,  416,  528,   416, 2224, 1668},
{ 536,  400,  528,  400,  512,   400, 2144, 1608},
{ 520,  388,  512,  388,  496,   388, 2080, 1560},
{ 500,  376,  496,  376,  480,   376, 2000, 1500},
{ 484,  360,  480,  360,  464,   360, 1936, 1452},
{ 468,  348,  464,  348,  448,   348, 1872, 1404},
{ 452,  336,  448,  336,  432,   336, 1808, 1356},
{ 436,  328,  432,  328,  416,   328, 1744, 1308},
{ 420,  316,  416,  316,  400,   316, 1680, 1260},
{ 408,  304,  400,  304,  384,   304, 1632, 1224},
{ 392,  292,  384,  292,  368,   292, 1568, 1176},
{ 380,  284,  368,  284,  352,   284, 1520, 1140},
{ 364,  272,  352,  272,  336,   272, 1456, 1092},
{ 352,  264,  352,  264,  336,   264, 1408, 1056},
{ 340,  256,  336,  256,  320,   256, 1360, 1020},
{ 328,  248,  320,  248,  304,   248, 1312, 984 },
{ 320,  240,  320,  240,  304,   240, 1280, 960 },
{ 308,  232,  304,  232,  288,   232, 1232, 924 },
{ 296,  224,  288,  224,  272,   224, 1184, 888 },
{ 288,  216,  288,  216,  272,   216, 1152, 864 },
{ 276,  208,  272,  208,  256,   208, 1104, 828 },
{ 268,  200,  256,  200,  240,   200, 1072, 804 },
{ 260,  192,  256,  192,  240,   192, 1040, 780 },
{ 248,  188,  240,  188,  224,   188, 992 , 744 },
{ 240,  180,  240,  180,  224,   180, 960 , 720 },
{ 232,  176,  224,  176,  208,   176, 928 , 696 },
{ 224,  168,  224,  168,  208,   168, 896 , 672 },
{ 216,  164,  208,  164,  192,   164, 864 , 648 },
{ 208,  156,  208,  156,  192,   156, 832 , 624 },
{ 204,  152,  192,  152,  176,   152, 816 , 612 },
{ 196,  148,  192,  148,  176,   148, 784 , 588 },
{ 188,  140,  176,  140,  160,   140, 752 , 564 },
{ 184,  136,  176,  136,  160,   136, 736 , 552 },
{ 176,  132,  176,  132,  160,   132, 704 , 528 },
{ 168,  128,  160,  128,  144,   128, 672 , 504 },
{ 164,  124,  160,  124,  144,   124, 656 , 492 },
{ 160,  120,  160,  120,  144,   120, 640 , 480 },
{ 152,  116,  144,  116,  128,   116, 608 , 456 },
{ 148,  112,  144,  112,  128,   112, 592 , 444 },
{ 144,  108,  144,  108,  128,   108, 576 , 432 },
{ 136,  104,  128,  104,  112,   104, 544 , 408 },
{ 132,  100,  128,  100,  112,   100, 528 , 396 },
{ 128,  96 ,  128,  96 ,  112,   96 , 512 , 384 },
{ 124,  92 ,  112,  92 ,  96 ,   92 , 496 , 372 },
{ 120,  88 ,  112,  88 ,  96 ,   88 , 480 , 360 },
{ 116,  88 ,  112,  88 ,  96 ,   88 , 464 , 348 },
{ 112,  84 ,  112,  84 ,  96 ,   84 , 448 , 336 },
{ 108,  80 ,  96 ,  80 ,  80 ,   80 , 432 , 324 },
{ 104,  76 ,  96 ,  76 ,  80 ,   76 , 416 , 312 },
{ 100,  76 ,  96 ,  76 ,  80 ,   76 , 400 , 300 },
{ 96 ,  72 ,  96 ,  72 ,  80 ,   72 , 384 , 288 },
{ 92 ,  68 ,  80 ,  68 ,  64 ,   68 , 368 , 276 },
{ 92 ,  68 ,  80 ,  68 ,  64 ,   68 , 368 , 276 },
{ 88 ,  64 ,  80 ,  64 ,  64 ,   64 , 352 , 264 },
{ 84 ,  64 ,  80 ,  64 ,  64 ,   64 , 336 , 252 },
{ 80 ,  60 ,  80 ,  60 ,  64 ,   60 , 320 , 240 },
{ 80 ,  60 ,  80 ,  60 ,  64 ,   60 , 320 , 240 },
};
#else
//vga
//10x(2x for optical 8x for digital)
UINT16 VDOZOOM_INFOR_TABLE[61][8] =
{
//sie_in      pre_out     ipe_out    crop size
{ 640,  480,  640,  480,  624,   480, 2560, 1920},
{ 624,  468,  624,  468,  608,   468, 2496, 1872},
{ 608,  456,  608,  456,  592,   456, 2432, 1824},
{ 592,  444,  592,  444,  576,   444, 2368, 1776},
{ 576,  432,  576,  432,  560,   432, 2304, 1728},
{ 560,  420,  560,  420,  544,   420, 2240, 1680},
{ 548,  412,  544,  412,  528,   412, 2192, 1644},
{ 536,  400,  528,  400,  512,   400, 2144, 1608},
{ 520,  388,  512,  388,  496,   388, 2080, 1560},
{ 508,  380,  496,  380,  480,   380, 2032, 1524},
{ 496,  372,  496,  372,  480,   372, 1984, 1488},
{ 484,  360,  480,  360,  464,   360, 1936, 1452},
{ 472,  352,  464,  352,  448,   352, 1888, 1416},
{ 460,  344,  448,  344,  432,   344, 1840, 1380},
{ 448,  336,  448,  336,  432,   336, 1792, 1344},
{ 436,  328,  432,  328,  416,   328, 1744, 1308},
{ 424,  320,  416,  320,  400,   320, 1696, 1272},
{ 416,  312,  416,  312,  400,   312, 1664, 1248},
{ 404,  304,  400,  304,  384,   304, 1616, 1212},
{ 392,  296,  384,  296,  368,   296, 1568, 1176},
{ 384,  288,  384,  288,  368,   288, 1536, 1152},
{ 364,  272,  352,  272,  336,   272, 1456, 1092},
{ 344,  260,  336,  260,  320,   260, 1376, 1032},
{ 328,  244,  320,  244,  304,   244, 1312, 984 },
{ 312,  232,  304,  232,  288,   232, 1248, 936 },
{ 296,  224,  288,  224,  272,   224, 1184, 888 },
{ 284,  212,  272,  212,  256,   212, 1136, 852 },
{ 268,  200,  256,  200,  240,   200, 1072, 804 },
{ 256,  192,  256,  192,  240,   192, 1024, 768 },
{ 244,  180,  240,  180,  224,   180, 976 , 732 },
{ 232,  172,  224,  172,  208,   172, 928 , 696 },
{ 220,  164,  208,  164,  192,   164, 880 , 660 },
{ 208,  156,  208,  156,  192,   156, 832 , 624 },
{ 196,  148,  192,  148,  176,   148, 784 , 588 },
{ 188,  140,  176,  140,  160,   140, 752 , 564 },
{ 180,  132,  176,  132,  160,   132, 720 , 540 },
{ 168,  128,  160,  128,  144,   128, 672 , 504 },
{ 160,  120,  160,  120,  144,   120, 640 , 480 },
{ 152,  116,  144,  116,  128,   116, 608 , 456 },
{ 144,  108,  144,  108,  128,   108, 576 , 432 },
{ 140,  104,  128,  104,  112,   104, 560 , 420 },
{ 132,  100,  128,  100,  112,   100, 528 , 396 },
{ 124,  92 ,  112,  92 ,  96 ,   92 , 496 , 372 },
{ 120,  88 ,  112,  88 ,  96 ,   88 , 480 , 360 },
{ 112,  84 ,  112,  84 ,  96 ,   84 , 448 , 336 },
{ 108,  80 ,  96 ,  80 ,  80 ,   80 , 432 , 324 },
{ 100,  76 ,  96 ,  76 ,  80 ,   76 , 400 , 300 },
{ 96 ,  72 ,  96 ,  72 ,  80 ,   72 , 384 , 288 },
{ 92 ,  68 ,  80 ,  68 ,  64 ,   68 , 368 , 276 },
{ 88 ,  64 ,  80 ,  64 ,  64 ,   64 , 352 , 264 },
{ 84 ,  60 ,  80 ,  60 ,  64 ,   60 , 336 , 252 },
{ 80 ,  60 ,  80 ,  60 ,  64 ,   60 , 320 , 240 },
{ 76 ,  56 ,  64 ,  56 ,  48 ,   56 , 304 , 228 },
{ 72 ,  52 ,  64 ,  52 ,  48 ,   52 , 288 , 216 },
{ 68 ,  52 ,  64 ,  52 ,  48 ,   52 , 272 , 204 },
{ 64 ,  48 ,  64 ,  48 ,  48 ,   48 , 256 , 192 },
{ 60 ,  44 ,  48 ,  44 ,  32 ,   44 , 240 , 180 },
{ 56 ,  44 ,  48 ,  44 ,  32 ,   44 , 224 , 168 },
{ 56 ,  40 ,  48 ,  40 ,  32 ,   40 , 224 , 168 },
{ 52 ,  40 ,  48 ,  40 ,  32 ,   40 , 208 , 156 },
{ 48 ,  36 ,  48 ,  36 ,  32 ,   36 , 192 , 144 },
};
#endif

//6x(2x for optical 4x for digital)
UINT16 VDOZOOM_INFOR_TABLE_2[61][8] =
{
//sie_in      pre_out     ipe_out    crop size
{ 640,  480,  640,  480,  624,   480, 2560, 1920},
{ 628,  472,  624,  472,  608,   472, 2512, 1884},
{ 620,  464,  608,  464,  592,   464, 2480, 1860},
{ 616,  460,  608,  460,  592,   460, 2464, 1848},
{ 608,  456,  608,  456,  592,   456, 2432, 1824},
{ 600,  448,  592,  448,  576,   448, 2400, 1800},
{ 592,  444,  592,  444,  576,   444, 2368, 1776},
{ 584,  436,  576,  436,  560,   436, 2336, 1752},
{ 576,  432,  576,  432,  560,   432, 2304, 1728},
{ 568,  428,  560,  428,  544,   428, 2272, 1704},
{ 560,  420,  560,  420,  544,   420, 2240, 1680},
{ 556,  416,  544,  416,  528,   416, 2224, 1668},
{ 548,  412,  544,  412,  528,   412, 2192, 1644},
{ 540,  404,  528,  404,  512,   404, 2160, 1620},
{ 532,  400,  528,  400,  512,   400, 2128, 1596},
{ 528,  396,  528,  396,  512,   396, 2112, 1584},
{ 520,  388,  512,  388,  496,   388, 2080, 1560},
{ 512,  384,  512,  384,  496,   384, 2048, 1536},
{ 508,  380,  496,  380,  480,   380, 2032, 1524},
{ 500,  376,  496,  376,  480,   376, 2000, 1500},
{ 496,  372,  496,  372,  480,   372, 1984, 1488},
{ 488,  364,  480,  364,  464,   364, 1952, 1464},
{ 484,  360,  480,  360,  464,   360, 1936, 1452},
{ 476,  356,  464,  356,  448,   356, 1904, 1428},
{ 472,  352,  464,  352,  448,   352, 1888, 1416},
{ 464,  348,  464,  348,  448,   348, 1856, 1392},
{ 460,  344,  448,  344,  432,   344, 1840, 1380},
{ 452,  340,  448,  340,  432,   340, 1808, 1356},
{ 448,  336,  448,  336,  432,   336, 1792, 1344},
{ 440,  332,  432,  332,  416,   332, 1760, 1320},
{ 436,  328,  432,  328,  416,   328, 1744, 1308},
{ 428,  320,  416,  320,  400,   320, 1712, 1284},
{ 424,  316,  416,  316,  400,   316, 1696, 1272},
{ 420,  312,  416,  312,  400,   312, 1680, 1260},
{ 412,  308,  400,  308,  384,   308, 1648, 1236},
{ 408,  304,  400,  304,  384,   304, 1632, 1224},
{ 404,  304,  400,  304,  384,   304, 1616, 1212},
{ 400,  300,  400,  300,  384,   300, 1600, 1200},
{ 392,  296,  384,  296,  368,   296, 1568, 1176},
{ 388,  292,  384,  292,  368,   292, 1552, 1164},
{ 384,  288,  384,  288,  368,   288, 1536, 1152},
{ 360,  268,  352,  268,  336,   268, 1440, 1080},
{ 336,  252,  336,  252,  320,   252, 1344, 1008},
{ 316,  236,  304,  236,  288,   236, 1264, 948 },
{ 296,  220,  288,  220,  272,   220, 1184, 888 },
{ 276,  208,  272,  208,  256,   208, 1104, 828 },
{ 260,  196,  256,  196,  240,   196, 1040, 780 },
{ 244,  180,  240,  180,  224,   180, 976 , 732 },
{ 228,  172,  224,  172,  208,   172, 912 , 684 },
{ 212,  160,  208,  160,  192,   160, 848 , 636 },
{ 200,  148,  192,  148,  176,   148, 800 , 600 },
{ 188,  140,  176,  140,  160,   140, 752 , 564 },
{ 176,  132,  176,  132,  160,   132, 704 , 528 },
{ 164,  124,  160,  124,  144,   124, 656 , 492 },
{ 156,  116,  144,  116,  128,   116, 624 , 468 },
{ 144,  108,  144,  108,  128,   108, 576 , 432 },
{ 136,  100,  128,  100,  112,   100, 544 , 408 },
{ 128,  96 ,  128,  96 ,  112,   96 , 512 , 384 },
{ 120,  88 ,  112,  88 ,  96 ,   88 , 480 , 360 },
{ 112,  84 ,  112,  84 ,  96 ,   84 , 448 , 336 },
{ 104,  80 ,  96 ,  80 ,  80 ,   80 , 416 , 312 },
};

#if 1
//1280x960
//8x dzoom
UINT16 VDOZOOM_INFOR_MODE_2_TABLE[61][8] =
{
{ 1280,  960,  1280,  960,  1264,   960, 2560, 1920},
{ 1236,  924,  1232,  924,  1216,   924, 2464, 1848},
{ 1192,  892,  1184,  892,  1168,   892, 2384, 1788},
{ 1152,  864,  1152,  864,  1136,   864, 2304, 1728},
{ 1112,  832,  1104,  832,  1088,   832, 2224, 1668},
{ 1076,  804,  1072,  804,  1056,   804, 2144, 1608},
{ 1040,  780,  1040,  780,  1024,   780, 2080, 1560},
{ 1004,  752,  992 ,  752,  976 ,   752, 2000, 1500},
{ 968 ,  724,  960 ,  724,  944 ,   724, 1936, 1452},
{ 936 ,  700,  928 ,  700,  912 ,   700, 1872, 1404},
{ 904 ,  676,  896 ,  676,  880 ,   676, 1808, 1356},
{ 872 ,  656,  864 ,  656,  848 ,   656, 1744, 1308},
{ 844 ,  632,  832 ,  632,  816 ,   632, 1680, 1260},
{ 816 ,  612,  816 ,  612,  800 ,   612, 1632, 1224},
{ 788 ,  588,  784 ,  588,  768 ,   588, 1568, 1176},
{ 760 ,  568,  752 ,  568,  736 ,   568, 1520, 1140},
{ 732 ,  548,  720 ,  548,  704 ,   548, 1456, 1092},
{ 708 ,  532,  704 ,  532,  688 ,   532, 1408, 1056},
{ 684 ,  512,  672 ,  512,  656 ,   512, 1360, 1020},
{ 660 ,  496,  656 ,  496,  640 ,   496, 1312, 984 },
{ 640 ,  480,  640 ,  480,  624 ,   480, 1280, 960 },
{ 616 ,  464,  608 ,  464,  592 ,   464, 1232, 924 },
{ 596 ,  448,  592 ,  448,  576 ,   448, 1184, 888 },
{ 576 ,  432,  576 ,  432,  560 ,   432, 1152, 864 },
{ 556 ,  416,  544 ,  416,  528 ,   416, 1104, 828 },
{ 536 ,  404,  528 ,  404,  512 ,   404, 1072, 804 },
{ 520 ,  388,  512 ,  388,  496 ,   388, 1040, 780 },
{ 500 ,  376,  496 ,  376,  480 ,   376, 992 , 744 },
{ 484 ,  364,  480 ,  364,  464 ,   364, 960 , 720 },
{ 468 ,  352,  464 ,  352,  448 ,   352, 928 , 696 },
{ 452 ,  340,  448 ,  340,  432 ,   340, 896 , 672 },
{ 436 ,  328,  432 ,  328,  416 ,   328, 864 , 648 },
{ 420 ,  316,  416 ,  316,  400 ,   316, 832 , 624 },
{ 408 ,  304,  400 ,  304,  384 ,   304, 816 , 612 },
{ 392 ,  296,  384 ,  296,  368 ,   296, 784 , 588 },
{ 380 ,  284,  368 ,  284,  352 ,   284, 752 , 564 },
{ 368 ,  276,  368 ,  276,  352 ,   276, 736 , 552 },
{ 352 ,  264,  352 ,  264,  336 ,   264, 704 , 528 },
{ 340 ,  256,  336 ,  256,  320 ,   256, 672 , 504 },
{ 332 ,  248,  320 ,  248,  304 ,   248, 656 , 492 },
{ 320 ,  240,  320 ,  240,  304 ,   240, 640 , 480 },
{ 308 ,  232,  304 ,  232,  288 ,   232, 608 , 456 },
{ 296 ,  224,  288 ,  224,  272 ,   224, 592 , 444 },
{ 288 ,  216,  288 ,  216,  272 ,   216, 576 , 432 },
{ 276 ,  208,  272 ,  208,  256 ,   208, 544 , 408 },
{ 268 ,  200,  256 ,  200,  240 ,   200, 528 , 396 },
{ 260 ,  192,  256 ,  192,  240 ,   192, 512 , 384 },
{ 248 ,  188,  240 ,  188,  224 ,   188, 496 , 372 },
{ 240 ,  180,  240 ,  180,  224 ,   180, 480 , 360 },
{ 232 ,  176,  224 ,  176,  208 ,   176, 464 , 348 },
{ 224 ,  168,  224 ,  168,  208 ,   168, 448 , 336 },
{ 216 ,  164,  208 ,  164,  192 ,   164, 432 , 324 },
{ 208 ,  156,  208 ,  156,  192 ,   156, 416 , 312 },
{ 204 ,  152,  192 ,  152,  176 ,   152, 400 , 300 },
{ 196 ,  148,  192 ,  148,  176 ,   148, 384 , 288 },
{ 188 ,  140,  176 ,  140,  160 ,   140, 368 , 276 },
{ 184 ,  136,  176 ,  136,  160 ,   136, 368 , 276 },
{ 176 ,  132,  176 ,  132,  160 ,   132, 352 , 264 },
{ 172 ,  128,  160 ,  128,  144 ,   128, 336 , 252 },
{ 164 ,  124,  160 ,  124,  144 ,   124, 320 , 240 },
{ 160 ,  120,  160 ,  120,  144 ,   120, 320 , 240 },
};
#else
//1280x960
//10x(2x for optical 8x for digital)
UINT16 VDOZOOM_INFOR_MODE_2_TABLE[61][8] =
{                                                    
{ 1280,  960,  1280,  960,  1264,   960, 2560, 1920},
{ 1248,  936,  1248,  936,  1232,   936, 2496, 1872},
{ 1216,  912,  1216,  912,  1200,   912, 2432, 1824},
{ 1184,  888,  1184,  888,  1168,   888, 2368, 1776},
{ 1156,  864,  1152,  864,  1136,   864, 2304, 1728},
{ 1124,  844,  1120,  844,  1104,   844, 2240, 1680},
{ 1096,  824,  1088,  824,  1072,   824, 2192, 1644},
{ 1072,  804,  1072,  804,  1056,   804, 2144, 1608},
{ 1044,  780,  1040,  780,  1024,   780, 2080, 1560},
{ 1016,  764,  1008,  764,  992 ,   764, 2032, 1524},
{ 992 ,  744,  992 ,  744,  976 ,   744, 1984, 1488},
{ 968 ,  724,  960 ,  724,  944 ,   724, 1936, 1452},
{ 944 ,  708,  944 ,  708,  928 ,   708, 1888, 1416},
{ 920 ,  688,  912 ,  688,  896 ,   688, 1840, 1380},
{ 896 ,  672,  896 ,  672,  880 ,   672, 1792, 1344},
{ 872 ,  656,  864 ,  656,  848 ,   656, 1744, 1308},
{ 852 ,  640,  848 ,  640,  832 ,   640, 1696, 1272},
{ 832 ,  624,  832 ,  624,  816 ,   624, 1664, 1248},
{ 808 ,  608,  800 ,  608,  784 ,   608, 1616, 1212},
{ 788 ,  592,  784 ,  592,  768 ,   592, 1568, 1176},
{ 768 ,  576,  768 ,  576,  752 ,   576, 1536, 1152},   //
{  728,  544,   720,  544,   704,   544, 1456, 1092},
{  692,  516,   688,  516,   672,   516, 1376, 1032},
{  656,  492,   656,  492,   640,   492, 1312, 984 },
{  624,  468,   624,  468,   608,   468, 1248, 936 },
{  592,  444,   592,  444,   576,   444, 1184, 888 },
{  564,  420,   560,  420,   544,   420, 1120, 840 },
{  536,  400,   528,  400,   512,   400, 1072, 804 },
{  508,  380,   496,  380,   480,   380, 1008, 756 },
{  484,  360,   480,  360,   464,   360, 960 , 720 },
{  456,  344,   448,  344,   432,   344, 912 , 684 },
{  436,  324,   432,  324,   416,   324, 864 , 648 },
{  412,  308,   400,  308,   384,   308, 816 , 612 },
{  392,  292,   384,  292,   368,   292, 784 , 588 },
{  372,  280,   368,  280,   352,   280, 736 , 552 },
{  352,  264,   352,  264,   336,   264, 704 , 528 },
{  336,  252,   336,  252,   320,   252, 672 , 504 },
{  320,  240,   320,  240,   304,   240, 640 , 480 },
{  304,  228,   304,  228,   288,   228, 608 , 456 },
{  288,  216,   288,  216,   272,   216, 576 , 432 },
{  272,  204,   272,  204,   256,   204, 544 , 408 },
{  260,  196,   256,  196,   240,   196, 512 , 384 },
{  248,  184,   240,  184,   224,   184, 496 , 372 },
{  236,  176,   224,  176,   208,   176, 464 , 348 },
{  224,  168,   224,  168,   208,   168, 448 , 336 },
{  212,  156,   208,  156,   192,   156, 416 , 312 },
{  200,  148,   192,  148,   176,   148, 400 , 300 },
{  192,  144,   192,  144,   176,   144, 384 , 288 },
{  180,  136,   176,  136,   160,   136, 352 , 264 },
{  172,  128,   160,  128,   144,   128, 336 , 252 },
{  164,  120,   160,  120,   144,   120, 320 , 240 },
{  156,  116,   144,  116,   128,   116, 304 , 228 },
{  148,  108,   144,  108,   128,   108, 288 , 216 },
{  140,  104,   128,  104,   112,   104, 272 , 204 },
{  132,  100,   128,  100,   112,   100, 256 , 192 },
{  128,  100,   128,  100,   112,   100, 256 , 192 },
{  128,  100,   128,  100,   112,   100, 256 , 192 },
{  128,  100,   128,  100,   112,   100, 256 , 192 },
{  128,  100,   128,  100,   112,   100, 256 , 192 },
{  128,  100,   128,  100,   112,   100, 256 , 192 },
{  128,  100,   128,  100,   112,   100, 256 , 192 },
//{  124,  92 ,   112,  92 ,   96 ,   92 , 240 , 180 },
//{  120,  88 ,   112,  88 ,   96 ,   88 , 240 , 180 },
//{  112,  84 ,   112,  84 ,   96 ,   84 , 224 , 168 },
//{  108,  80 ,   96 ,  80 ,   80 ,   80 , 208 , 156 },
//{  100,  76 ,   96 ,  76 ,   80 ,   76 , 192 , 144 },
};
#endif

//1280x960
//6x(2x for optical 4x for digital)
UINT16 VDOZOOM_INFOR_MODE_2_TABLE_2[61][8] =
{
{ 1280,  960,  1280,  960,  1264,   960, 2560, 1920},
{ 1260,  944,  1248,  944,  1232,   944, 2512, 1884},
{ 1244,  932,  1232,  932,  1216,   932, 2480, 1860},
{ 1232,  924,  1232,  924,  1216,   924, 2464, 1848},
{ 1216,  912,  1216,  912,  1200,   912, 2432, 1824},
{ 1200,  900,  1200,  900,  1184,   900, 2400, 1800},
{ 1184,  888,  1184,  888,  1168,   888, 2368, 1776},
{ 1168,  876,  1168,  876,  1152,   876, 2336, 1752},
{ 1156,  864,  1152,  864,  1136,   864, 2304, 1728},
{ 1140,  856,  1136,  856,  1120,   856, 2272, 1704},
{ 1124,  844,  1120,  844,  1104,   844, 2240, 1680},
{ 1112,  832,  1104,  832,  1088,   832, 2224, 1668},
{ 1096,  824,  1088,  824,  1072,   824, 2192, 1644},
{ 1084,  812,  1072,  812,  1056,   812, 2160, 1620},
{ 1068,  800,  1056,  800,  1040,   800, 2128, 1596},
{ 1056,  792,  1056,  792,  1040,   792, 2112, 1584},
{ 1044,  780,  1040,  780,  1024,   780, 2080, 1560},
{ 1028,  772,  1024,  772,  1008,   772, 2048, 1536},
{ 1016,  764,  1008,  764,  992 ,   764, 2032, 1524},
{ 1004,  752,  992 ,  752,  976 ,   752, 2000, 1500},
{ 992 ,  744,  992 ,  744,  976 ,   744, 1984, 1488},
{ 980 ,  732,  976 ,  732,  960 ,   732, 1952, 1464},
{ 968 ,  724,  960 ,  724,  944 ,   724, 1936, 1452},
{ 956 ,  716,  944 ,  716,  928 ,   716, 1904, 1428},
{ 944 ,  708,  944 ,  708,  928 ,   708, 1888, 1416},
{ 932 ,  696,  928 ,  696,  912 ,   696, 1856, 1392},
{ 920 ,  688,  912 ,  688,  896 ,   688, 1840, 1380},
{ 908 ,  680,  896 ,  680,  880 ,   680, 1808, 1356},
{ 896 ,  672,  896 ,  672,  880 ,   672, 1792, 1344},
{ 884 ,  664,  880 ,  664,  864 ,   664, 1760, 1320},
{ 872 ,  656,  864 ,  656,  848 ,   656, 1744, 1308},
{ 860 ,  644,  848 ,  644,  832 ,   644, 1712, 1284},
{ 852 ,  636,  848 ,  636,  832 ,   636, 1696, 1272},
{ 840 ,  628,  832 ,  628,  816 ,   628, 1680, 1260},
{ 828 ,  620,  816 ,  620,  800 ,   620, 1648, 1236},
{ 820 ,  612,  816 ,  612,  800 ,   612, 1632, 1224},
{ 808 ,  608,  800 ,  608,  784 ,   608, 1616, 1212},
{ 800 ,  600,  800 ,  600,  784 ,   600, 1600, 1200},
{ 788 ,  592,  784 ,  592,  768 ,   592, 1568, 1176},
{ 780 ,  584,  768 ,  584,  752 ,   584, 1552, 1164},
{ 768 ,  576,  768 ,  576,  752 ,   576, 1536, 1152},
{ 716 ,  536,  704 ,  536,  688 ,   536, 1424, 1068},
{ 672 ,  504,  672 ,  504,  656 ,   504, 1344, 1008},
{ 628 ,  472,  624 ,  472,  608 ,   472, 1248, 936 },
{ 588 ,  440,  576 ,  440,  560 ,   440, 1168, 876 },
{ 552 ,  416,  544 ,  416,  528 ,   416, 1104, 828 },
{ 516 ,  388,  512 ,  388,  496 ,   388, 1024, 768 },
{ 484 ,  364,  480 ,  364,  464 ,   364, 960 , 720 },
{ 456 ,  340,  448 ,  340,  432 ,   340, 912 , 684 },
{ 424 ,  320,  416 ,  320,  400 ,   320, 848 , 636 },
{ 400 ,  300,  400 ,  300,  384 ,   300, 800 , 600 },
{ 372 ,  280,  368 ,  280,  352 ,   280, 736 , 552 },
{ 348 ,  260,  336 ,  260,  320 ,   260, 688 , 516 },
{ 328 ,  244,  320 ,  244,  304 ,   244, 656 , 492 },
{ 308 ,  228,  304 ,  228,  288 ,   228, 608 , 456 },
{ 288 ,  216,  288 ,  216,  272 ,   216, 576 , 432 },
{ 268 ,  200,  256 ,  200,  240 ,   200, 528 , 396 },
{ 252 ,  188,  240 ,  188,  224 ,   188, 496 , 372 },
{ 236 ,  176,  224 ,  176,  208 ,   176, 464 , 348 },
{ 220 ,  164,  208 ,  164,  192 ,   164, 432 , 324 },
{ 208 ,  156,  208 ,  156,  192 ,   156, 416 , 312 },
};

//1440x1080
UINT16 VDOZOOM_INFOR_MODE_3_TABLE[21][8] =
{
//sie_in      pre_out     ipe_out    crop size
{ 640,  480,  640,  480,  624,  480, 2592, 1944},
{ 592,  448,  592,  448,  576,  448, 2416, 1812},
{ 560,  416,  560,  416,  544,  416, 2256, 1692},
{ 512,  388,  512,  388,  496,  388, 2112, 1580},
{ 480,  364,  480,  364,  464,  364, 1968, 1472},
{ 448,  340,  448,  340,  432,  340, 1840, 1376},
{ 416,  316,  416,  316,  400,  316, 1712, 1284},
{ 400,  296,  400,  296,  384,  296, 1600, 1196},
{ 368,  276,  368,  276,  352,  276, 1488, 1116},
{ 336,  256,  336,  256,  320,  256, 1392, 1040},
{ 320,  240,  320,  240,  304,  240, 1296,  972},
{ 304,  224,  304,  224,  288,  224, 1216,  908},
{ 272,  208,  272,  208,  256,  208, 1136,  848},
{ 256,  196,  256,  196,  240,  196, 1056,  788},
{ 240,  180,  240,  180,  224,  180,  976,  736},
{ 224,  168,  224,  168,  208,  168,  912,  688},
{ 208,  160,  208,  160,  192,  160,  848,  640},
{ 192,  148,  192,  148,  176,  148,  800,  600},
{ 176,  136,  176,  136,  160,  136,  752,  560},
{ 176,  128,  176,  128,  160,  128,  688,  520},
{ 160,  120,  160,  120,  144,  120,  656,  488},
};

//#NT#2009/11/14#Jarkko Chang -begin
DZOOM_INFOR VDOZOOM_INFOR = {_Ratio_4_3, VDOZOOM_INFOR_TABLE};
//#NT#2009/11/14#Jarkko Chang -end
DZOOM_INFOR VDOZOOM_INFOR_MODE_2 = {_Ratio_4_3, VDOZOOM_INFOR_MODE_2_TABLE};
DZOOM_INFOR VDOZOOM_INFOR_MODE_3 = {_Ratio_4_3, VDOZOOM_INFOR_MODE_2_TABLE};

INT zoom_index = 10;
SIZE_INFOR    LCD_Size, JPEG_Pre_Size,JPEG_Cap_Size;
SIZE_INFOR    IPE_Out_Prv_Size, IPE_Out_Cap_Size;
SIZE_INFOR    PRE_Hsub_Prv_Size, PRE_Hsub_Cap_Size;
SIZE_INFOR    IME_Out_Prv_Size, IME_Out_Cap_Size;
SIZE_INFOR    PRE_Crop_Prv_Size, PRE_Crop_Cap_Size;

void Set_DzoomIndex(INT idx)
{
    zoom_index = idx;
}
INT Get_DzoomIndex(void)
{
    return zoom_index;
}
void Set_DzoomMaxIndex(UINT16 index)
{
    MAX_Dzoom_Step = index;
}

UINT16 Get_DzoomMaxIndex(void)
{
    return MAX_Dzoom_Step;
}

DZOOM_INFOR* Get_DZoomInfor(struct SIE_PRE_PARAM_STRUCT *SIE_PRE_PARAM)
{
    DZOOM_INFOR *pTableInfor;

    pTableInfor = &VDOZOOM_INFOR;

    switch(SIE_PRE_PARAM->VGAType)
    {
        case SENSOR_OUT_TWO_LINE:
        case SENSOR_OUT_THREE_LINE:
        default:
            if (SIE_PRE_PARAM->ModeSel==MONITOR_MODE_2)
            {
                pTableInfor = &VDOZOOM_INFOR_MODE_2;
            }
            else if (SIE_PRE_PARAM->ModeSel==MONITOR_MODE_3)
            {
                pTableInfor = &VDOZOOM_INFOR_MODE_3;
            }
            else if (SIE_PRE_PARAM->ModeSel==MONITOR_MODE)
            {
                pTableInfor = &VDOZOOM_INFOR;
            }
            return pTableInfor;
    }
}

UINT16 Get_HRatio(UINT32 ImgRatioIdx, UINT32 DefaultRatioIdx)
{
    return usImgRatioTable[ImgRatioIdx][DefaultRatioIdx];
}

UINT16 Get_VRatio(UINT32 ImgRatioIdx, UINT32 DefaultRatioIdx)
{
    return usImgRatioTable[DefaultRatioIdx][ImgRatioIdx];
}

UINT32 Adj_VSize(UINT32 InSize, UINT16 VRatio, UINT16 Align)
{
    UINT32 rtValue;

    rtValue = InSize * VRatio / IMG_RATIO_UINT;
    rtValue = (rtValue + (Align - 1)) / Align * Align;
    return rtValue;
}

UINT32 Adj_HSize(UINT32 InSize, UINT16 HRatio, UINT16 Align)
{
    UINT32 rtValue;

    rtValue = InSize;
    rtValue = InSize * HRatio / IMG_RATIO_UINT;
    rtValue = (rtValue + (Align - 1)) / Align * Align;
    return rtValue;
}

UINT32 Adj_PreLineOffset(UINT32 LineOffset, PRE_VGAFormatEnum VGAType, UINT8 PreBitDepth)
{
    UINT32 lofs;

    lofs = LineOffset * PreBitDepth / 8;
    if (VGAType == SENSOR_OUT_THREE_LINE)
    {
        lofs = (lofs + (PRE_BLOCK_BUF_SIZE/3 - 1)) / (PRE_BLOCK_BUF_SIZE/3) * (PRE_BLOCK_BUF_SIZE/3);
    }
    else if (VGAType == SENSOR_OUT_TWO_LINE)
    {
        lofs = (lofs + (PRE_BLOCK_BUF_SIZE/2 - 1)) / (PRE_BLOCK_BUF_SIZE/2) * (PRE_BLOCK_BUF_SIZE/2);
    }
    return lofs;
}

void Set_digitalzoom(UINT DzoomIdx, struct SIE_PRE_PARAM_STRUCT *SIE_PRE_PARAM)
{
    UINT32 lofs, i, idx, AdjSize;
    DZOOM_INFOR *pTableInfor;
    UINT16 (*DzTable)[8], HRatio, VRatio, AdjTable[1][8];

    if(DzoomIdx < 10)
    {
        DzoomIdx = 10;
    }
    else if(DzoomIdx > Get_DzoomMaxIndex())
    {
        DzoomIdx = Get_DzoomMaxIndex();
    }

    pTableInfor = Get_DZoomInfor(SIE_PRE_PARAM);
    DzTable = (UINT16(*)[8])pTableInfor->DzTable;

    SetIPPSizeInfor(_SensorRatioIdx, pTableInfor->SensorRatio);
    //for image pipeline
    if (GetIPPSizeInfor(_SensorRatioIdx) != gImageAlgInfo.ImageRatio)
    {
        //get adjust ratio
        HRatio = Get_HRatio(gImageAlgInfo.ImageRatio, GetIPPSizeInfor(_SensorRatioIdx));
        VRatio = Get_VRatio(gImageAlgInfo.ImageRatio, GetIPPSizeInfor(_SensorRatioIdx));

        for (i = 0; i < 8; i ++) AdjTable[0][i] = DzTable[DzoomIdx - 10][i];

        if ((HRatio != IMG_RATIO_UINT) && (VRatio == IMG_RATIO_UINT))
        {
            AdjTable[0][6] = Adj_HSize(AdjTable[0][6], HRatio, 16);
            if (SIE_PRE_PARAM->VGAType == SENSOR_OUT_TWO_LINE)
            {
                AdjTable[0][0] = Adj_HSize(AdjTable[0][0], HRatio, 16);
                AdjSize = AdjTable[0][0] / 2;
            }
            else if (SIE_PRE_PARAM->VGAType == SENSOR_OUT_THREE_LINE)
            {
                AdjTable[0][0] = Adj_HSize(AdjTable[0][0], HRatio, 12);
                AdjSize = ((AdjTable[0][0] - THREE_LINE_DUMMY_PIX) / 3);
            }
            else
            {
                AdjTable[0][0] = Adj_HSize(AdjTable[0][0], HRatio, 16);
                AdjSize = AdjTable[0][0];
            }

            if (AdjSize  > DzTable[DzoomIdx - 10][2])
            {
                AdjTable[0][2] = DzTable[DzoomIdx - 10][2];
            }
            else
            {
                AdjTable[0][2] = AdjSize / 16 * 16;
            }
            AdjTable[0][4] = AdjTable[0][2] - IPE_HSIZE_IODIFF;
        }
        else if ((HRatio == IMG_RATIO_UINT) && (VRatio != IMG_RATIO_UINT))
        {
            AdjTable[0][1] = Adj_VSize(AdjTable[0][1], VRatio, 4);
            AdjTable[0][7] = Adj_VSize(AdjTable[0][7], VRatio, 4);
            if (SIE_PRE_PARAM->VGAType == SENSOR_OUT_TWO_LINE)
            {
                AdjTable[0][5] = AdjTable[0][3] = AdjTable[0][1] * 2;
            }
            else if (SIE_PRE_PARAM->VGAType == SENSOR_OUT_THREE_LINE)
            {
                AdjTable[0][5] = AdjTable[0][3] = AdjTable[0][1] * 3;
            }
            else
            {
                AdjTable[0][5] = AdjTable[0][3] = AdjTable[0][1];
            }
        }
        else
        {
            debug_err(("dzoom..not support\r\n"));
        }

        idx = 0;
        DzTable = (UINT16(*)[8])AdjTable;
    }
    else
    {
        idx = DzoomIdx - 10;
    }

    if (gImageAlgInfo.ImageRatio != gImageAlgInfo.DispRatio)
    {
        //get adjust ratio
        HRatio = Get_HRatio(gImageAlgInfo.ImageRatio, gImageAlgInfo.DispRatio);
        VRatio = Get_VRatio(gImageAlgInfo.ImageRatio, gImageAlgInfo.DispRatio);

        SetIPPSizeInfor(_ImeOut1Hsize, Adj_HSize(DispSizeInfo.uiDisplayFBWidth, HRatio, 16));
        SetIPPSizeInfor(_ImeOut1Vsize, Adj_VSize(DispSizeInfo.uiDisplayFBHeight, VRatio, 4));
        SetIPPSizeInfor(_ImeOut1LineOffset, GetIPPSizeInfor(_ImeOut1Hsize));
    }
    else
    {
        SetIPPSizeInfor(_ImeOut1Hsize, DispSizeInfo.uiDisplayFBWidth);
        SetIPPSizeInfor(_ImeOut1Vsize, DispSizeInfo.uiDisplayFBHeight);
        SetIPPSizeInfor(_ImeOut1LineOffset, GetIPPSizeInfor(_ImeOut1Hsize));
    }

    lofs = Adj_PreLineOffset(DzTable[idx][2], SIE_PRE_PARAM->VGAType, gImageAlgInfo.PrePrvBitDepth);
    SetIPPSizeInfor(_PreOutLineOffset, lofs);
    SetIPPSizeInfor(_IpeOutHsize,DzTable[idx][4]);
    SetIPPSizeInfor(_IpeOutVsize,DzTable[idx][5]);
    SetIPPSizeInfor(_PreOutHsize,DzTable[idx][2]);
    SetIPPSizeInfor(_PreOutVsize,DzTable[idx][3]);
    SetIPPSizeInfor(_PreCropHsize,DzTable[idx][0]);
    SetIPPSizeInfor(_PreCropVsize,DzTable[idx][1]);
    SetIPPSizeInfor(_IpeCapOutHsize,DzTable[idx][6] - IPE_HSIZE_IODIFF);
    SetIPPSizeInfor(_IpeCapOutVsize,DzTable[idx][7]);
    SetIPPSizeInfor(_ImeCapOutHsize,DzTable[idx][6] - IPE_HSIZE_IODIFF);
    SetIPPSizeInfor(_ImeCapOutVsize,DzTable[idx][7]);
    SetIPPSizeInfor(_PreCropCapHsize,DzTable[idx][6]);
    SetIPPSizeInfor(_PreCropCapVsize,DzTable[idx][7]);
}

void SetImageOutSize(UINT16 Hsize, UINT16 Vsize)
{
    SetIPPSizeInfor(_JpegCapHsize,Hsize);
    SetIPPSizeInfor(_JpegCapVsize,Vsize);
}

UINT32 Get_DzoomPrvMaxBuffer(struct SIE_PRE_PARAM_STRUCT *SIE_PRE_PARAM)
{
    DZOOM_INFOR *pTableInfor;
    UINT16 (*DzTable)[8];
    UINT32 lofs;

//    pTableInfor = Get_DZoomInfor(SIE_PRE_PARAM);
    pTableInfor = &VDOZOOM_INFOR_MODE_2;
    DzTable = (UINT16(*)[8])pTableInfor->DzTable;
    lofs = Adj_PreLineOffset(DzTable[0][2], SIE_PRE_PARAM->VGAType, gImageAlgInfo.PrePrvBitDepth);
    return (lofs * DzTable[0][5]);
}

UINT32 Get_DzoomPrvMaxBuffer_SIE(struct SIE_PRE_PARAM_STRUCT *SIE_PRE_PARAM)
{
    UINT32 Hsize, Vsize, BufferSize;

    Hsize = Vsize = 0;
//#NT#2009/10/16#Jarkko Chang -begin
    Hsize = ((HD_Total_Prv_2)-(ACT_STRX_Prv_2));
    Vsize = ((VD_Total_Prv_2)-(ACT_STRY_Prv_2));
#if 0
    if (SIE_PRE_PARAM->ModeSel==MONITOR_MODE_2)
    {
        Hsize = ((HD_Total_Prv_1)-(ACT_STRX_Prv_1));
        Vsize = ((VD_Total_Prv_1)-(ACT_STRY_Prv_1));
    }
    else if (SIE_PRE_PARAM->ModeSel==MONITOR_MODE_3)
    {
        Hsize = ((HD_Total_Prv_2)-(ACT_STRX_Prv_2));
        Vsize = ((VD_Total_Prv_2)-(ACT_STRY_Prv_2));
    }
    else if (SIE_PRE_PARAM->ModeSel==MONITOR_MODE)
    {
        Hsize = ((HD_Total_Prv)-(ACT_STRX_Prv));
        Vsize = ((VD_Total_Prv)-(ACT_STRY_Prv));
    }
#endif
//#NT#2009/10/16#Jarkko Chang -end
    Hsize = Hsize&0xfffffffc;

    if (SIE_PRE_PARAM->SieBitDepth == SIE_OUT_PACK_8BIT)
    {
        BufferSize = Hsize*Vsize;
    }
    else if (SIE_PRE_PARAM->SieBitDepth == SIE_OUT_PACK_12BIT)
    {
        BufferSize = Hsize*Vsize*3/2;
    }
    else if (SIE_PRE_PARAM->SieBitDepth == SIE_OUT_PACK_16BIT)
    {
        BufferSize = Hsize*Vsize*2;
    }
    else
    {
        BufferSize = Hsize*Vsize*2;//give me more if you're not sure
        debug_err(("ERROR\r\n"));
    }

    BufferSize = (BufferSize+3)&0xfffffffc;

    return BufferSize;
}

UINT32 Get_DzoomCapMaxFieldBuffer_SIE(struct SIE_PRE_PARAM_STRUCT *SIE_PRE_PARAM)
{
    UINT32 Hsize, Vsize, BufferSize;

    Hsize = ((HD_Total_Cap)-(ACT_STRX_Cap));
    Vsize = ((VD_Total_Cap)-(ACT_STRY_Cap));

    Hsize = Hsize&0xfffffffc;

    if (SIE_PRE_PARAM->SieBitDepth == SIE_OUT_PACK_8BIT)
    {
        BufferSize = Hsize*Vsize;
    }
    else if (SIE_PRE_PARAM->SieBitDepth == SIE_OUT_PACK_12BIT)
    {
        BufferSize = Hsize*Vsize*3/2;
    }
    else if (SIE_PRE_PARAM->SieBitDepth == SIE_OUT_PACK_16BIT)
    {
        BufferSize = Hsize*Vsize*2;
    }
    else
    {
        BufferSize = Hsize*Vsize*2;//give me more if you're not sure
        debug_err(("ERROR\r\n"));
    }

    BufferSize = (BufferSize+3)&0xfffffffc;

    return BufferSize;
}

UINT32 Get_DzoomCapMaxBuffer(struct SIE_PRE_PARAM_STRUCT *SIE_PRE_PARAM)
{
    UINT32 Width, Height;
    UINT16 (*DzTable)[8], HRatio, VRatio;
    DZOOM_INFOR *pTableInfor;

    pTableInfor = Get_DZoomInfor(SIE_PRE_PARAM);
    DzTable = (UINT16(*)[8])pTableInfor->DzTable;

    HRatio = Get_HRatio(gImageAlgInfo.ImageRatio, GetIPPSizeInfor(_SensorRatioIdx));
    VRatio = Get_VRatio(gImageAlgInfo.ImageRatio, GetIPPSizeInfor(_SensorRatioIdx));

    Width = (Adj_HSize(DzTable[0][6], HRatio, 16) * gImageAlgInfo.PrePrvBitDepth / 8);
    Height = Adj_VSize(DzTable[0][7], VRatio, 4);
    return (Width * Height);
}
#endif//----------------------------------------------------------------------------------------------------
